<%- include('header') %>
  <div class="container">
    <% if(session.user) { %>
      <div class="row">
        <% if(errors){ errors.forEach(err=>{ %>
          <span class="alert alert-danger"> <%= err.msg %></span>
          <% }) } %>
        <div class="col-md-12 shadow rounded border p-2">
          <form class=""  method="POST" enctype="multipart/form-data">
            <div class="form-group">
              <label >title</label>
              <input name="title" class="form-control">
            </div>
            <div class="form-group">
              <label >description</label>
              <textarea name="description" class="form-control"></textarea>
            </div>
            <div class="form-group">
              <label>image</label>
              <input name="image" type="file" accept="image/*" class="form-control">
            </div>
            <div class="form-group">
              <input class="form-control btn btn-primary" type="submit" value="new image">
            </div>
          </form>
        </div>
      </div>
    <% } %>
    <h1 class="mt-4">Latest photos</h1>
    <div class="row">
      <% if(latest && latest.length){ latest.forEach((img)=>{ %>
        <div class="col-md-4 p-1">
          <div class="shadow py-2 px-1">
            <a href="/photos/<%= img._id %>"><img loading="lazy" width="100%" height="300" src="<%= img.image %>" alt="<%= img.title %>"></a>
            <h3><a href="/photos/<%= img._id %>"><%= img.title %></a></h3>
            <div class="d-flex justify-content-between alig-items-center">
              <a href="/users/<%= img.user_id._id %>"><%= img.user_id.username %></a>
              <span>
                <svg height="18" viewBox="0 0 24 24" width="20" >
                  <g>
                    <path d="m12 21c-5.196 0-9.815-3.067-11.767-7.814-.31-.753-.31-1.618 0-2.371 1.952-4.748 6.571-7.815 11.767-7.815s9.815 3.067 11.767 7.814c.31.753.31 1.618 0 2.371-1.952 4.748-6.571 7.815-11.767 7.815zm0-17c-4.789 0-9.045 2.824-10.842 7.194-.21.512-.21 1.099 0 1.611 1.797 4.371 6.053 7.195 10.842 7.195s9.045-2.824 10.842-7.194c.21-.512.21-1.099 0-1.611-1.797-4.371-6.053-7.195-10.842-7.195z"/>
                  </g>
                  <g>
                    <path d="m12 16c-2.206 0-4-1.794-4-4s1.794-4 4-4 4 1.794 4 4-1.794 4-4 4zm0-7c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3z"/>
                  </g>
                </svg>
                <%= img.views %>
              </span>
            </div>
          </div>
        </div>
      <% }) }else {%>
        <div class="col-md-12">
          <p>there is no images yet</p>
        </div>
      <% } %>
    </div>

    <h1 class="mt-4">Most viewed</h1>
    <div class="row">
      <% if(mostViewed && mostViewed.length){ mostViewed.forEach((img)=>{ %>
        <div class="col-md-4 p-1">
          <div class="shadow py-2 px-1">
            <a href="/photos/<%= img._id %>"><img loading="lazy" width="100%" height="300" src="<%= img.image %>" alt="<%= img.title %>"></a>
            <h3><a href="/photos/<%= img._id %>"><%= img.title %></a></h3>
            <div class="d-flex justify-content-between alig-items-center">
              <a href="/users/<%= img.user_id._id %>"><%= img.user_id.username %></a>
              <span>
                <svg height="18" viewBox="0 0 24 24" width="20" >
                  <g>
                    <path d="m12 21c-5.196 0-9.815-3.067-11.767-7.814-.31-.753-.31-1.618 0-2.371 1.952-4.748 6.571-7.815 11.767-7.815s9.815 3.067 11.767 7.814c.31.753.31 1.618 0 2.371-1.952 4.748-6.571 7.815-11.767 7.815zm0-17c-4.789 0-9.045 2.824-10.842 7.194-.21.512-.21 1.099 0 1.611 1.797 4.371 6.053 7.195 10.842 7.195s9.045-2.824 10.842-7.194c.21-.512.21-1.099 0-1.611-1.797-4.371-6.053-7.195-10.842-7.195z"/>
                  </g>
                  <g>
                    <path d="m12 16c-2.206 0-4-1.794-4-4s1.794-4 4-4 4 1.794 4 4-1.794 4-4 4zm0-7c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3z"/>
                  </g>
                </svg>
                <%= img.views %>
              </span>
            </div>
          </div>
        </div>
      <% }) }else {%>
        <div class="col-md-12">
          <p>there is no images yet</p>
        </div>
      <% } %>
    </div>
    <div class="row">
      <a href="/photos" class="col-md-12 btn btn-primary my-2">See More</a>
    </div>
  </div>
<%- include('footer') %>
